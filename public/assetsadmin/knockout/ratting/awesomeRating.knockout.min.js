!function(a){a.fn.awesomeRating=function(b){if(b=b||{},!b.values&&b.valueMax){b.values=[];for(var c=b.valueMin||1;c<=b.valueMax;c+=b.valueStep||1)b.values.push(c)}var d=a.fn.awesomeRating.defaults;return this.each(function(){if(!this._awesomeRatingApi){var c=a(this),e={values:{list:b.values||d.values||[],initial:b.valueInitial||d.valueInitial||null,current:null},html:{base:b.htmlBase||d.htmlBase,event:b.htmlEvent||d.htmlEvent},css:{base:b.cssBase||d.cssBase,selected:b.cssBaseSelected||d.cssBaseSelected,unselected:b.cssBaseUnselected||d.cssBaseUnselected,values:{selected:b.cssValuesSelected||d.cssValuesSelected||[],unselected:b.cssValuesUnselected||d.cssValuesUnselected||[]},hover:b.cssHover||d.cssHover||null,fractional:b.cssFractional||d.cssFractional||null},settings:{applyHoverCss:b.applyHoverCss!==!1&&d.applyHoverCss,readonly:b.readonly||d.readonly||!1,allowFractional:b.allowFractional||d.allowFractional||!1,eventName:b.eventName||d.eventName||"rated"},external:{$:{element:c,target:a(b.targetSelector||d.targetSelector),rates:null,fractional:null},val:function(a){return void 0===a?e.values.current:void e.storeValue(a)}},temp:{fractionalIndex:-1},storeValue:function(a){a!==e.values.current&&(e.values.current=a,e.updateTarget(),e.triggerEvent(),e.updateFractionalIndex(),e.updateCss())},updateTarget:function(){e.external.$.target&&e.external.$.target.text(e.values.current)&&e.external.$.target.val(e.values.current)},triggerEvent:function(){e.external.$.element.trigger(e.settings.eventName,[e.values.current])},toggleBaseCss:function(){var b=null==e.values.current;e.external.$.rates.each(function(c){var d=a(this);!b&&e.settings.allowFractional&&(b=e.temp.fractionalIndex===c),d.toggleClass(e.css.selected,!b),d.toggleClass(e.css.unselected,b),e.css.values.selected.length==e.values.list.length&&e.css.values.unselected.length==e.values.list.length&&a.each(e.values.list,function(a,c){var f=e.settings.allowFractional?e.calculateFractional(e.values.current,e.values.list[a]):-1,g=f>0&&1>f;d.toggleClass(e.css.values.selected[a],!b&&(c===e.values.current||g)),d.toggleClass(e.css.values.unselected[a],b&&(c===e.values.current||g))}),e.values.list[c]===e.values.current&&(b=!0)})},toggleFractionalCss:function(){e.external.$.fractional.each(function(b){var c=a(this);if(b!==e.temp.fractionalIndex)c.hide();else{var d=e.calculateFractional(e.values.current,e.values.list[b]);c.css("display","initial"),c.width(d+"em")}})},updateCss:function(){e.toggleBaseCss(),e.settings.allowFractional&&e.toggleFractionalCss()},updateCssHover:function(b){e.external.$.rates.each(function(c){a(this).toggleClass(e.css.hover,b>=c)}),e.settings.allowFractional&&e.external.$.fractional.each(function(c){a(this).toggleClass(e.css.hover,b>=c)})},calculateFractional:b.calculateFractional||d.calculateFractional||function(a,b){return 1-(b-a)},updateFractionalIndex:function(){e.temp.fractionalIndex=-1,e.external.$.rates.each(function(a){if(-1===e.temp.fractionalIndex&&e.settings.allowFractional){var b=e.settings.allowFractional?e.calculateFractional(e.values.current,e.values.list[a]):-1;b>0&&1>b&&(e.temp.fractionalIndex=a)}})}};a.each(e.values.list,function(a,b){var c=e.external.$.element.append(e.html.base).find(":last-child");c.toggleClass(e.css.base,!0),c.toggleClass(e.css.unselected,!0),e.settings.readonly||(c.on(e.html.event,function(){e.storeValue(b)}),e.settings.applyHoverCss&&c.hover(function(){e.updateCssHover(a)},function(){e.updateCssHover(-1)}))}),e.external.$.rates=e.external.$.element.children(),e.settings.allowFractional&&e.external.$.rates.each(function(b){var c=a(this).before(e.html.base).prev();c.toggleClass(e.css.base,!0),c.toggleClass(e.css.fractional,!0),c.toggleClass(e.css.selected,!0),e.css.values.selected.length==e.values.list.length&&e.css.values.unselected.length==e.values.list.length&&c.toggleClass(e.css.values.selected[b]),e.settings.readonly||(c.on(e.html.event,function(){e.storeValue(e.values.list[b])}),e.settings.applyHoverCss&&c.hover(function(){e.updateCssHover(b)},function(){e.updateCssHover(-1)}))}),e.external.$.fractional=e.external.$.element.find("."+e.css.fractional),e.storeValue(e.values.initial),this._awesomeRatingApi=e.external}})},a.fn.awesomeRating.defaults={values:[1,2,3,4,5],valueInitial:null,cssBase:"rating-star fa",cssBaseSelected:"fa-star",cssBaseUnselected:"fa-star-o",cssValuesSelected:null,cssValuesUnselected:null,cssHover:"rating-star-hover",cssFractional:"rating-star-fractional",targetSelector:null,htmlBase:"<div></div>",htmlEvent:"click",applyHoverCss:!0,readonly:!1,allowFractional:!1,calculateFractional:null,eventName:"rated"}}(jQuery),function(a){ko.bindingHandlers.awesomeRating={init:function(b,c,d){var e=c();if(!ko.isObservable(e))throw new Error("The value must be an observable.");var f=ko.unwrap(e),g=d.get("awesomeRatingOptions")||{};g.valueInitial=f,a(b).awesomeRating(g).on("rated",function(a,b){e(b)})},update:function(a,b){var c=b(),d=ko.unwrap(c);a._awesomeRatingApi&&a._awesomeRatingApi.val(d)}}}(jQuery);